(function(){var f,d,c,g=[].indexOf||function(a){for(var b=0,e=this.length;b<e;b++)if(b in this&&this[b]===a)return b;return-1};d=function(a){return a.match(/[a-z]+:\/\/([^\/]+)/i)[1].match(/((^[A-Fa-f\d\.:]+$)|(^[^\.]+$)|((?:(?:[^\.]+\.)?((?:[^\.\s]{2})(?:(?:\.[^\.\s][^\.\s])|(?:[^\.\s]+)))))$)/)[0]};f=function(){function a(b,a){this.name=b;this["default"]=null!=a?a:[];this.cache=localStorage[this.name]?JSON.parse(localStorage[this.name]):this["default"]}a.prototype.contains=function(b){return 0<=
g.call(this.cache,b)};a.prototype.add=function(b){this.cache.push(b);return this._update()};a.prototype.addOnce=function(b){if(!this.contains(b))return this.add(b)};a.prototype.remove=function(b){this.cache.splice(this.cache.indexOf(b),1);return this._update()};a.prototype._update=function(){return localStorage[this.name]=JSON.stringify(this.cache)};return a}();c=new (function(){function a(){this.domains=new f("enabled")}a.prototype.toggleIcon=function(b){b=d(b.url);if(this.domains.contains(b))return chrome.browserAction.setIcon({path:"icon_enabled.png"}),
chrome.browserAction.setTitle({title:"Disable MathML & LaTeX on "+b});chrome.browserAction.setIcon({path:"icon.png"});return chrome.browserAction.setTitle({title:"Enable MathML & LaTeX on "+b})};a.prototype.processTab=function(b){var a;a=d(b.url);if(this.domains.contains(a))return chrome.tabs.executeScript(b.id,{file:"inject.js"})};a.prototype.toggleTab=function(b){var a;a=d(b.url);this.domains.contains(a)?this.domains.remove(a):this.domains.addOnce(a);return chrome.tabs.reload(b.id)};return a}());
chrome.tabs.onUpdated.addListener(function(a,b,e){if("loading"===b.status)return c.processTab(e),c.toggleIcon(e)});chrome.tabs.onActiveChanged.addListener(function(a,b){return chrome.tabs.get(a,function(a){return c.toggleIcon(a)})});chrome.browserAction.onClicked.addListener(function(a){return c.toggleTab(a)})}).call(this);
