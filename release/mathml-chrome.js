(function(){var e,d,g=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};e=function(a){return a.match(/[a-z]+:\/\/([^\/]+)/i)[1].match(/((^[A-Fa-f\d\.:]+$)|(^[^\.]+$)|((?:(?:[^\.]+\.)?((?:[^\.\s]{2})(?:(?:\.[^\.\s][^\.\s])|(?:[^\.\s]+)))))$)/)[0]};var c=function(a,b){this.name=a;this["default"]=null!=b?b:[];this.cache=localStorage[this.name]?JSON.parse(localStorage[this.name]):this["default"]};c.prototype.contains=function(a){return 0<=g.call(this.cache,
a)};c.prototype.add=function(a){this.cache.push(a);return this._update()};c.prototype.addOnce=function(a){if(!this.contains(a))return this.add(a)};c.prototype.remove=function(a){this.cache.splice(this.cache.indexOf(a),1);return this._update()};c.prototype._update=function(){return localStorage[this.name]=JSON.stringify(this.cache)};var f=function(){this.domains=new c("enabled")};f.prototype.toggleIcon=function(a){a=e(a.url);if(this.domains.contains(a))return chrome.browserAction.setIcon({path:"icon_enabled.png"}),
chrome.browserAction.setTitle({title:"Disable MathML & LaTeX on "+a});chrome.browserAction.setIcon({path:"icon.png"});return chrome.browserAction.setTitle({title:"Enable MathML & LaTeX on "+a})};f.prototype.processTab=function(a){var b;b=e(a.url);if(this.domains.contains(b))return chrome.tabs.executeScript(a.id,{file:"inject.js"})};f.prototype.toggleTab=function(a){var b;b=e(a.url);this.domains.contains(b)?this.domains.remove(b):this.domains.addOnce(b);return chrome.tabs.reload(a.id)};d=new f;chrome.tabs.onUpdated.addListener(function(a,
b,c){if("loading"===b.status)return d.processTab(c),d.toggleIcon(c)});chrome.tabs.onActiveChanged.addListener(function(a){return chrome.tabs.get(a,function(a){return d.toggleIcon(a)})});chrome.browserAction.onClicked.addListener(function(a){return d.toggleTab(a)})}).call(this);
